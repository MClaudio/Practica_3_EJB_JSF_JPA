<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets">
    <h:head>
        <title>Agregar Factura</title>
    </h:head>
    <h:body>
        <h:form id="cabecera">
            <label>Buscar usuario</label>
            <h:inputText id="cedula" value="#{facturaBean.cedula}" required="true"/>
            <p>
                <h:commandButton value="Buscar" action="#{facturaBean.buscarUsuario}" />
            </p>
        </h:form>
        <h:outputText value="#{facturaBean.usuario.cedula}"/>

        <br />
        <h:form>
            <label>Buscar producto</label>
            <h:inputText id="producto" value="#{facturaBean.productoNombre}" required="true"/>
            <p>
                <h:commandButton value="Buscar" action="#{facturaBean.buscarProducto}" />
            </p>
        </h:form>

        <h:form>
            <h:outputText value="#{facturaBean.producto.nombre}"/>
            <h:commandButton value="AgregarProducto" action="#{facturaBean.addProducto}" />
        </h:form>
        <br />
        <h3>JSF 2.3: dataTable</h3>
        <h:form>
            <h:dataTable value="#{facturaBean.facturaDetalles}" var="detalle" styleClass="tabla"
                         headerClass="cabeceraTabla" rowClasses="filaPar,filaImpar">
                <h:column>
                    <f:facet name="header">Nombre</f:facet>
                    <h:outputText value="#{detalle.producto.nombre}" />
                </h:column>
                <h:column>
                    <f:facet name="header">Precio unitario</f:facet>
                    <h:outputText value="#{detalle.producto.precio}" />
                </h:column>
                <h:column>
                    <f:facet name="header">Cantidad</f:facet>
                    <h:commandButton value="-" action="#{facturaBean.deleteCantidad(detalle)}" />
                    <h:outputText value="#{detalle.cantidad}" />
                    <h:commandButton value="+" action="#{facturaBean.addCantidad(detalle)}" />
                </h:column>               
                <h:column>
                    <f:facet name="header">Sub Total</f:facet>
                    <h:outputText value="#{detalle.subtotal}" />
                </h:column>

            </h:dataTable>
        </h:form>


        <br />

        <!-- primera fila -->
        <h:outputText value="Sub Total:"/>
        <h:outputText id="subTotal" value="#{facturaBean.facturaCabecera.subTotal}"/>
        <br />
        <!-- segunda fila -->
        <h:outputText value="Iva:"/>
        <h:outputText id="iva" value="#{facturaBean.facturaCabecera.iva*100} %"/>
        <br />
        <h:outputText value="Total:"/>
        <h:outputText id="total" value="#{facturaBean.facturaCabecera.total}"/>
        <br />
        <h:form>
            <h:commandButton id="guardar" value="Generar factura" action="#{facturaBean.generarFactura}" />
        </h:form>
    </h:body>
</html>